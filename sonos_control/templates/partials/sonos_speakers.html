{% load static %}
<div class="container-fluid">
  <div class="row">
    <!-- Speaker Tabs -->
    <div class="col-md-3">
      <div class="nav flex-column nav-pills"
           id="speaker-tabs"
           role="tablist"
           aria-orientation="vertical">
        {% for info in speaker_info %}
          {% if info.is_coordinator %}
            <a class="nav-link {% if forloop.first %}active{% endif %}"
               id="speaker-tab-{{ info.uid }}"
               data-toggle="pill"
               href="#speaker-content-{{ info.uid }}"
               role="tab"
               aria-controls="speaker-content-{{ info.uid }}"
               aria-selected="{% if forloop.first %}true{% else %}false{% endif %}">{{ info.group_label }}</a>
          {% endif %}
        {% endfor %}
      </div>
    </div>
    <!-- Speaker Content -->
    <div class="col-md-9 speaker-dropzone">
      <div class="tab-content" id="speaker-tabContent">
        {% for info in speaker_info %}
          {% if info.is_coordinator %}
            <div class="tab-pane fade {% if forloop.first %}show active{% endif %}"
                 id="speaker-content-{{ info.uid }}"
                 role="tabpanel"
                 aria-labelledby="speaker-tab-{{ info.uid }}"
                 ondragover="handleDragOver(event)"
                 ondrop="handleDrop(event, '{{ info.uid }}')">
              <div class="card mb-3">
                <div class="row no-gutters">
                  <div class="col-md-12">
                    <h2 class="mt-8 text-center">{{ info.group_label }}</h2>
                    <img src="{{ info.album_art }}"
                         class="album-art-img"
                         alt="Album Art"
                         onerror="this.onerror=null;this.src='{% static 'default_album_art.webp' %}';">
                    <button class="btn btn-primary play-pause-button"
                            id="play-pause-button-{{ info.uid }}"
                            onclick="togglePlayPause('{{ info.uid }}', '{{ info.play_state }}')">
                      {% if info.play_state == 'PLAYING' %}
                        &#10074;&#10074;
                      {% else %}
                        &#9654;
                      {% endif %}
                    </button>
                  </div>
                  <div class="col-md-12">
                    <h5 class="track-title">
                      <strong>Title:</strong> {{ info.track }}
                    </h5>
                    <p class="track-artist">
                      <strong>Artist:</strong> {{ info.artist }}
                    </p>
                    <p class="track-album">
                      <strong>Album:</strong> {{ info.album }}
                    </p>
                  </div>
                  <div class="col-md-9">
                    <!-- Volume Controls -->
                    <button class="volume-btn volume-down"
                            onclick="adjustVolume('{{ info.uid }}', decreaseVolume('{{ info.uid }}'))">
                      <i class="fas fa-volume-down"></i>
                    </button>
                    <input type="range"
                           class="volume-slider"
                           min="0"
                           max="100"
                           value="{{ info.volume }}"
                           id="volume-slider-{{ info.uid }}"
                           onchange="adjustVolume('{{ info.uid }}', this.value)">
                    <button class="volume-btn volume-up"
                            onclick="adjustVolume('{{ info.uid }}', increaseVolume('{{ info.uid }}'))">
                      <i class="fas fa-volume-up"></i>
                    </button>
                  </div>
                  <div class="col-md-3">
                    <button onclick="openModal('{{ info.uid }}')" class="group-btn">Group</button>
                  </div>
                </div>
                <!-- Queue Section -->
                <hr class="my-4">
                <div class="queue-container">
                  <div class="d-flex justify-content-between">
                    <h5 class="d-inline">Queue:</h5>
                    <button class="btn btn-danger" onclick="clearQueue('{{ info.uid }}')">Clear Queue</button>
                  </div>
                  <ul class="queue-list list-group" style="padding-left: 0; margin-left: 0">
                    {% for track in info.queue %}
                      <li class="list-group-item" style="padding-left: 0;">
                        <div class="media"
                             onclick="playTrack('{{ info.uid }}', {{ forloop.counter0 }})">
                          <img src="{{ track.album_art }}"
                               class="mr-3"
                               alt="Album Art"
                               style="width: 60px;
                                      height: 60px"
                               onerror="this.onerror=null;this.src='{% static 'default_album_art.webp' %}';">
                          <div class="media-body">
                            <h6 class="mt-0">{{ track.title }}</h6>
                            {{ track.artist }}
                          </div>
                        </div>
                      </li>
                    {% empty %}
                      <li class="list-group-item text-center" style="padding-left: 0;">No tracks in the queue</li>
                    {% endfor %}
                  </ul>
                </div>
              </div>
            </div>
          {% endif %}
        {% endfor %}
      </div>
    </div>
  </div>
</div>
